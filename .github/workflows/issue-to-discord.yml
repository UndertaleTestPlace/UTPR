name: "ðŸ”” Project Issue â†’ Discord"

on:
  issues:
    types:
      - opened
      - edited
      - closed
      - reopened
  workflow_dispatch: {}   # optional manual trigger for testing

jobs:
  discord_notify:
    runs-on: ubuntu-latest
    steps:
      - name: Notify Discord of Issue Change
        uses: ilshidur/action-discord@v2
        with:
          webhook: ${{ secrets.DISCORD_WEBHOOK_URL }}
          username: GitHub-Projects
          avatar_url: https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png
          embed: |
            {
              "title": "${{ github.event.issue.title }}",
              "url": "${{ github.event.issue.html_url }}",
              "description": "**${{ github.event.action }}** by @${{ github.actor }}",
              "fields": [
                {
                  "name": "State",
                  "value": "${{ github.event.issue.state }}",
                  "inline": true
                },
                {
                  "name": "Assignees",
                  "value": "${{ 
                    (github.event.issue.assignees && length(github.event.issue.assignees) > 0) 
                      && join(github.event.issue.assignees.*.login, ', ') 
                      || 'None' 
                  }}",
                  "inline": true
                },
                {
                  "name": "Labels",
                  "value": "${{ 
                    (github.event.issue.labels && length(github.event.issue.labels) > 0) 
                      && join(github.event.issue.labels.*.name, ', ') 
                      || 'None' 
                  }}",
                  "inline": true
                }
              ]
            }
